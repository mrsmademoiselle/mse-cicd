name: MSE-CICD

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # Setup
    - name: Installing Java
      run: sudo apt-get update && sudo apt-get install -y openjdk-17-jdk
    - name: Installing Ant
      run: sudo apt-get install ant
    
    # Build & Test
    - name: Building
      working-directory: ./rock-paper-scissor
      run: ant -f build.xml compile
    - name: Testing
      working-directory: ./rock-paper-scissor
      run: ant -f build.xml test
      
    # Package
    - name: Packaging
      working-directory: ./rock-paper-scissor
      run: ant package
    - name: Archiving
      uses: actions/upload-artifact@v2
      with:
        working-directory: ./rock-paper-scissor
        name: mse-rockpaperscissor.jar
        path: dist/mse-rockpaperscissor.jar
